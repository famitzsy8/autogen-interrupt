team_name: research_team

agents:
  user_proxy:
    display_name: User
    description: A human admin who can approve plans and provide guidance. Call this agent for approvals, troubleshooting, or secrets/API keys.
    ui_summary: >
      Represents the human decision-maker who can clarify requirements, approve plans, and provide feedback. Call this agent whenever the team needs direction or confirmation from the user.
    system_message: ''
    agent_class: UserProxyAgent
    input_func: queue_based_input
    name: user_proxy
    model_client_stream: false
    reflect_on_tool_use: false

  planner:
    display_name: Planner
    description: Call this Agent if you need to build a plan.
    ui_summary: >
      Builds detailed 5-step plans for solving tasks, coordinating team members, and revising plans based on feedback from admin and quality_assurance.
    system_message: |
      You are planning a step-by-step research investigation into a question given by a human user.
      Your plan should include the following structure:
      1. It should include the next 3 steps to undertake
      2. It should clearly reference the agents in the team that can do work for you.
        --> quality_assurance: Is here to review any plan made by you
        --> web_search_agent: Can do the actual web searches for you
        --> report_writer: Is here to write up a report, as soon as the investigation is concluded
    agent_class: AssistantAgent
    name: planner
    model_client_stream: true
    reflect_on_tool_use: false
    include_state_in_context: true

  quality_assurance:
    display_name: Quality Assurance
    description: Quality assurance agent that checks plan and execution quality.
    ui_summary: >
      Reviews plans and execution for bugs or errors, suggests resolutions, and analyzes problems to think of different approaches when tasks aren't solved.
    system_message: |
      You are here of the Quality Assurance department. Follow these instructions:
      1. Double check the plan,
      2. if there's a bug or error suggest a resolution
      3. If the task is not solved, analyze the problem, revisit your assumption, collect additional info you need, and think of a different approach.
    agent_class: AssistantAgent
    name: quality_assurance
    model_client_stream: true
    reflect_on_tool_use: false
    include_state_in_context: true

  web_search_agent:
    display_name: Web Search Agent
    description: Call this Agent if you need to search the web for information.
    ui_summary: >
      Searches the web for information to support research tasks and gather external data.
    system_message: |
      You are a web search agent. You have the ability to make queries to the web, and get a text full of links in return that try to answer your question.
    agent_class: AssistantAgent
    name: web_search_agent
    tools:
      python_tools:
        - web_search
    model_client_stream: true
    reflect_on_tool_use: false
    include_state_in_context: true

  report_writer:
    display_name: Report Writer
    description: Call this agent if the research is done and we want to terminate.
    ui_summary: >
      Writes final reports summarizing research findings with sources, then terminates the task if research is complete, or yields back to the Planner if more work is needed.
    system_message: |
      Look at the message history. Case 1 -- The research has been concluded successfully: the research has been done, you write the final report regarding the task and the result of the research run. Make sure to include sources from the web search (if he was called). Then terminate. Case 2 -- The research has not been concluded yet: Yield back to the Planner.
    agent_class: AssistantAgent
    name: report_writer
    model_client_stream: true
    reflect_on_tool_use: false
    include_state_in_context: true

tasks:
  main_task:
    description: >
      Research task: Investigate and provide comprehensive findings on the given topic.
      This task will be conducted by a team of specialists working together:

      The `planner` agent: Plans and re-plans the intermediate steps to be able to comprehensively report on the query
      The `quality_assurance`: Approves or critiques the plans that are made
      The `web_search_agent`: Main agent that browses the internet based on the plan
      The `report_writer`: Gathers all findings together and synthesizes them into a well-written report

      When all the agents agree that the task is sufficiently well researched, output a strucutured report and end the run! (by writing <TERMINATE>)

team:
  mcp_url: null
  params_class: SseServerParams
  mcp_timeout: 60
  group_chat_class: SelectorGroupChat
  group_chat_manager_class: SelectorGroupChatManager
  group_chat_args:
    has_user_proxy: true
    user_proxy_name: user_proxy
    max_turns: 60
    default_selector_prompt: >

      # Overview
      You select the next agent to speak based on the current research state and handoff instructions.

      # Context Information

      1. The names of the agents to choose from
      2. The state of the current research
      3. The Handoff Instructions

      ## The names of the agents to choose from

      {participants}

      ## The State of the Current Research

      {state_of_run}

      ## The Handoff Instructions

      {handoff_context}

      # How to Determine the next Agent

      1. Look at the state of the current research to understand what has been done and what the next step should be.
      2. Look at the handoff instructions to see how to map the next step to an agent.
      3. Validate that the selected agent exists in the list of participants.

      # Output
      Return SOLELY the name of the agent that should be called next.

    default_selector_prompt_advanced: true
  enable_state_context: true
  initial_handoff_context: >
    ## Agent Responsibilities

    - If research/planning is needed → **planner**
    - If quality assurance or feedback is needed → **quality_assurance**
    - If web search is needed → **web_search_agent**
    - If report writing or task completion is needed → **report_writer**

    ## Escalation & Sync Points

    - If the research is complete → **report_writer**

    ## Special User Requests

    --
  initial_state_of_run: >
    # State of Research

    ## What we have done so far

    Nothing yet - investigation is just starting.

    ## Research Outlook (Next Steps)

    - Begin investigation

    ## Concrete Next Step
    
    We start with the planner

llm:
  model_client_class: OpenAIChatCompletionClient
  model_client_args:
    model: gpt-4o-mini
    api_key: ${OPENAI_API_KEY}  # Will be loaded from environment

prompts:
  planning_prompt: >
    You have attempted to call a tool without first providing a plan.
    You MUST first provide a step-by-step plan as a bulleted list.
    After the text of your plan, you MUST re-issue the same tool call you just attempted, and WITH the arguments according to the tool description and the plan.
    Your final response must include BOTH the textual plan AND the `tool_calls` data structure.

  arguments_prompt: >
    {warning}
    Our agent wants to call the following tool: {tool_name}
    For this he provided the following arguments: {sent_arguments}
    We checked them and they are false in structure and possibly wrong in content. Here is the expected STRUCTURE description of the arguments (not the content)\n
    """
    {description}
    """
    \n
    Again: The arguments in the descriptions ARE JUST EXAMPLES FOR THE STRUCTURE. Now you will need to infer the correct content of the arguments by the last instruction here:

    And this is the last instruction that was given to the agent:
    """
    {last_message}
    """

    Infer the correct arguments for this tool call using the structure in the description and the last instruction.
    Return ONLY the JSON object of arguments for this tool. Do not include any extra text.

    DO NOT MAKE UP ARGUMENTS. ONLY USE THE LAST INSTRUCTION AND THE DESCRIPTION.

  summarization_system_prompt: >
    You are the summarizer for the messages. You will get the last message sent: this one you need to summarize.
    Summarize research findings in roughly 15-word sentences, focusing on the most novel information.
