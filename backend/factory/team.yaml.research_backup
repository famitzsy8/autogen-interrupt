team_name: research_team

agents:
  user_proxy:
    display_name: User
    description: A human admin who can approve plans and provide guidance. Call this agent for approvals, troubleshooting, or secrets/API keys.
    system_message: ''
    agent_class: UserProxyAgent
    input_func: queue_based_input
    name: user_proxy
    model_client_stream: false
    reflect_on_tool_use: false

  planner:
    display_name: Planner
    description: Call this Agent if you need to build a plan.
    system_message: |
      You are an AI Planner, follow these guidelines:
      1. Your plan should include 5 steps, you should provide a detailed plan to solve the task.
      2. Post project review isn't needed.
      3. Revise the plan based on feedback from admin and quality_assurance.
      4. The plan should include the various team members, explain which step is performed by whom.
      5. Do not show appreciation in your responses, say only what is necessary.
      6. The final message should include an accurate answer to the user request
    agent_class: AssistantAgent
    name: planner
    model_client_stream: true
    reflect_on_tool_use: false

  quality_assurance:
    display_name: Quality Assurance
    description: Quality assurance agent that checks plan and execution quality.
    system_message: |
      You are an AI Quality Assurance. Follow these instructions:
      1. Double check the plan,
      2. if there's a bug or error suggest a resolution
      3. If the task is not solved, analyze the problem, revisit your assumption, collect additional info you need, and think of a different approach.
    agent_class: AssistantAgent
    name: quality_assurance
    model_client_stream: true
    reflect_on_tool_use: false

  web_search_agent:
    display_name: Web Search Agent
    description: Call this Agent if you need to search the web for information.
    system_message: |
      You are a web search agent. You search the web for information.
    agent_class: AssistantAgent
    name: web_search_agent
    tools:
      python_tools:
        - web_search
    model_client_stream: true
    reflect_on_tool_use: false

  report_writer:
    display_name: Report Writer
    description: Call this agent if the research is done and we want to terminate.
    system_message: |
      Look at the message history. Case 1 -- The research has been concluded successfully: the research has been done, you write the final report regarding the task and the result of the research run. Make sure to include sources from the web search (if he was called). Then terminate. Case 2 -- The research has not been concluded yet: Yield back to the Planner.
    agent_class: AssistantAgent
    name: report_writer
    model_client_stream: true
    reflect_on_tool_use: false

tasks:
  main_task:
    description: >
      Research task: Investigate and provide comprehensive findings on the given topic.
      This task will be conducted by a team of specialists working together.

team:
  mcp_url: null
  params_class: SseServerParams
  mcp_timeout: 60
  group_chat_class: HierarchicalGroupChat
  group_chat_manager_class: HierarchicalGroupChatManager
  group_chat_args:
    has_user_proxy: true
    user_proxy_name: user_proxy
    allowed_transitions:
      user:
        - planner
      user_proxy:
        - planner
        - quality_assurance
        - web_search_agent
      planner:
        - user_proxy
        - quality_assurance
        - web_search_agent
        - report_writer
      quality_assurance:
        - planner
        - user_proxy
        - report_writer
      web_search_agent:
        - planner
        - user_proxy
      report_writer:
        - planner
        - user_proxy
    max_turns: 60
    default_selector_prompt: >
      # Overview
      You select the next agent to speak based on the current research state and handoff instructions.

      # Context Information

      1. The names of the agents to choose from
      2. The state of the current research
      3. The Handoff Instructions

      ## The names of the agents to choose from

      {participants}

      ## The State of the Current Research

      {state_of_run}

      ## The Handoff Instructions

      {handoff_context}

      # How to Determine the next Agent

      1. Look at the state of the current research to understand what has been done and what the next step should be.
      2. Look at the handoff instructions to see how to map the next step to an agent.
      3. Validate that the selected agent exists in the list of participants.

      # Output
      Return SOLELY the name of the agent that should be called next.
    default_selector_prompt_advanced: true
  initial_handoff_context: >
    # Handoff Instructions

    ## Agent Responsibilities
    - If research/planning is needed → **planner**
    - If quality assurance or feedback is needed → **quality_assurance**
    - If web search is needed → **web_search_agent**
    - If report writing or task completion is needed → **report_writer**
    - If user approval or guidance is needed → **user_proxy**

    ## Escalation & Sync Points
    - If the research is complete → **report_writer**
    - If feedback or approval is needed → **user_proxy**

    ## Special User Requests

    --
  initial_state_of_run: >
    # State of Research

    ## Task
    [Will be populated with the actual task]

    ## What we have done so far
    Nothing yet - research is just starting.

    ## Research Outlook (Next Steps)
    - Begin research with planner

    ## Concrete Next Step
    We start with the planner to create a research plan

llm:
  model_client_class: OpenAIChatCompletionClient
  model_client_args:
    model: gpt-4o-mini
    api_key: ${OPENAI_API_KEY}  # Will be loaded from environment

prompts:
  planning_prompt: >
    You have attempted to call a tool without first providing a plan.
    You MUST first provide a step-by-step plan as a bulleted list.
    After the text of your plan, you MUST re-issue the same tool call you just attempted, and WITH the arguments according to the tool description and the plan.
    Your final response must include BOTH the textual plan AND the `tool_calls` data structure.

  arguments_prompt: >
    {warning}
    Our agent wants to call the following tool: {tool_name}
    For this he provided the following arguments: {sent_arguments}
    We checked them and they are false in structure and possibly wrong in content. Here is the expected STRUCTURE description of the arguments (not the content):
    """
    {description}
    """

    Again: The arguments in the descriptions ARE JUST EXAMPLES FOR THE STRUCTURE. Now you will need to infer the correct content of the arguments by the last instruction here:

    And this is the last instruction that was given to the agent:
    """
    {last_message}
    """

    Infer the correct arguments for this tool call using the structure in the description and the last instruction.
    Return ONLY the JSON object of arguments for this tool. Do not include any extra text.

    DO NOT MAKE UP ARGUMENTS. ONLY USE THE LAST INSTRUCTION AND THE DESCRIPTION.

  summarization_system_prompt: >
    You are the summarizer for research team messages. You will get:
    - the last message sent: this one you need to summarize

    You will summarize in the following style:
    - extract the most important finding or insight from the message
    - turn it into a concise, roughly 15-word sentence if possible
    - if multiple key findings exist, prioritize the most novel or actionable one
